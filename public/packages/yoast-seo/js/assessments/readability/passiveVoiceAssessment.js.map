{"version":3,"sources":["../../../../js/assessments/readability/passiveVoiceAssessment.js"],"names":["AssessmentResult","require","formatNumber","inRange","inRangeEndInclusive","stripTags","stripIncompleteTags","Mark","marker","map","getLanguageAvailability","availableLanguages","calculatePassiveVoiceResult","passiveVoice","i18n","score","percentage","passives","length","total","recommendedValue","passiveVoiceURL","hasMarks","text","sprintf","dgettext","passiveVoiceMarker","paper","researcher","getResearch","sentence","marked","original","passiveVoiceAssessment","passiveVoiceResult","assessmentResult","setScore","setText","setHasMarks","module","exports","identifier","getResult","isApplicable","isLanguageAvailable","getLocale","hasText","getMarks"],"mappings":"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","file":"passiveVoiceAssessment.js","sourcesContent":["\"use strict\";\nvar AssessmentResult = require(\"../../values/AssessmentResult.js\");\nvar formatNumber = require(\"../../helpers/formatNumber.js\");\nvar inRange = require(\"../../helpers/inRange.js\").inRangeEndInclusive;\nvar stripTags = require(\"../../stringProcessing/stripHTMLTags\").stripIncompleteTags;\nvar Mark = require(\"../../values/Mark.js\");\nvar marker = require(\"../../markers/addMark.js\");\nvar map = require(\"lodash/map\");\nvar getLanguageAvailability = require(\"../../helpers/getLanguageAvailability.js\");\nvar availableLanguages = [\"en\", \"de\", \"fr\", \"es\"];\n/**\n * Calculates the result based on the number of sentences and passives.\n * @param {object} passiveVoice The object containing the number of sentences and passives\n * @param {object} i18n The object used for translations.\n * @returns {{score: number, text}} resultobject with score and text.\n */\nvar calculatePassiveVoiceResult = function (passiveVoice, i18n) {\n    var score;\n    var percentage = (passiveVoice.passives.length / passiveVoice.total) * 100;\n    percentage = formatNumber(percentage);\n    var recommendedValue = 10;\n    var passiveVoiceURL = \"<a href='https://yoa.st/passive-voice' target='_blank'>\";\n    var hasMarks = (percentage > 0);\n    if (percentage <= 10) {\n        // Green indicator.\n        score = 9;\n    }\n    if (inRange(percentage, 10, 15)) {\n        // Orange indicator.\n        score = 6;\n    }\n    if (percentage > 15) {\n        // Red indicator.\n        score = 3;\n    }\n    if (score >= 7) {\n        return {\n            score: score,\n            hasMarks: hasMarks,\n            text: i18n.sprintf(i18n.dgettext(\"js-text-analysis\", \n            // Translators: %1$s expands to the number of sentences in passive voice, %2$s expands to a link on yoast.com,\n            // %3$s expands to the anchor end tag, %4$s expands to the recommended value.\n            \"%1$s of the sentences contain %2$spassive voice%3$s, \" +\n                \"which is less than or equal to the recommended maximum of %4$s.\"), percentage + \"%\", passiveVoiceURL, \"</a>\", recommendedValue + \"%\"),\n        };\n    }\n    return {\n        score: score,\n        hasMarks: hasMarks,\n        text: i18n.sprintf(i18n.dgettext(\"js-text-analysis\", \n        // Translators: %1$s expands to the number of sentences in passive voice, %2$s expands to a link on yoast.com,\n        // %3$s expands to the anchor end tag, %4$s expands to the recommended value.\n        \"%1$s of the sentences contain %2$spassive voice%3$s, \" +\n            \"which is more than the recommended maximum of %4$s. Try to use their active counterparts.\"), percentage + \"%\", passiveVoiceURL, \"</a>\", recommendedValue + \"%\"),\n    };\n};\n/**\n * Marks all sentences that have the passive voice.\n *\n * @param {object} paper The paper to use for the assessment.\n * @param {object} researcher The researcher used for calling research.\n * @returns {object} All marked sentences.\n */\nvar passiveVoiceMarker = function (paper, researcher) {\n    var passiveVoice = researcher.getResearch(\"passiveVoice\");\n    return map(passiveVoice.passives, function (sentence) {\n        sentence = stripTags(sentence);\n        var marked = marker(sentence);\n        return new Mark({\n            original: sentence,\n            marked: marked,\n        });\n    });\n};\n/**\n * Runs the passiveVoice module, based on this returns an assessment result with score and text.\n * @param {object} paper The paper to use for the assessment.\n * @param {object} researcher The researcher used for calling research.\n * @param {object} i18n The object used for translations.\n * @returns {object} the Assessmentresult\n */\nvar passiveVoiceAssessment = function (paper, researcher, i18n) {\n    var passiveVoice = researcher.getResearch(\"passiveVoice\");\n    var passiveVoiceResult = calculatePassiveVoiceResult(passiveVoice, i18n);\n    var assessmentResult = new AssessmentResult();\n    assessmentResult.setScore(passiveVoiceResult.score);\n    assessmentResult.setText(passiveVoiceResult.text);\n    assessmentResult.setHasMarks(passiveVoiceResult.hasMarks);\n    return assessmentResult;\n};\nmodule.exports = {\n    identifier: \"passiveVoice\",\n    getResult: passiveVoiceAssessment,\n    isApplicable: function (paper) {\n        var isLanguageAvailable = getLanguageAvailability(paper.getLocale(), availableLanguages);\n        return (isLanguageAvailable && paper.hasText());\n    },\n    getMarks: passiveVoiceMarker,\n};\n//# sourceMappingURL=passiveVoiceAssessment.js.map"]}